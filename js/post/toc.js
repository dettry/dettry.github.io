function initTOC(){const e=document.querySelector(".page-container");const t=document.querySelector(".post-page-container");const o=document.querySelector(".pc-post-toc");const c=document.querySelector(".tablet-post-toc");if(KEEP.utils.hasToc){KEEP.utils.tocHelper={pcTocNavSections:[],tabletTocNavSections:[],getActiveIndex(e){if(!Array.isArray(e))return;const t=20;const{isHideHeader:o,headerWrapperDom:c}=KEEP.utils;const i=o?0:c.getBoundingClientRect().height;let n=e.findIndex(e=>{return e&&e.getBoundingClientRect().top-(t+i)>0});if(n===-1){n=e.length-1}else if(n>0){n--}return n},activeNav(){this.activateNavByIndex(o,this.getActiveIndex(this.pcTocNavSections));this.activateNavByIndex(c,this.getActiveIndex(this.tabletTocNavSections))},registerTocNav(){const e=e=>{return[...e.querySelectorAll(".post-toc li a.nav-link")].map(e=>{const t=document.getElementById(decodeURI(e.getAttribute("href")).replace("#",""));KEEP.utils.title2Top4HTag(e,t,500);return t})};this.pcTocNavSections=e(o);this.tabletTocNavSections=e(c)},activateNavByIndex(e,t){const o=e.querySelectorAll(".post-toc li a.nav-link")[t];if(!o||o.classList.contains("active-current"))return;e.querySelectorAll(".post-toc .active").forEach(e=>{e.classList.remove("active","active-current")});o.classList.add("active","active-current");let c=o.parentNode;while(!c.matches(".post-toc")){if(c.matches("li"))c.classList.add("active");c=c.parentNode}const i=e.querySelector(".post-toc-wrap");window.anime({targets:i,duration:200,easing:"linear",scrollTop:i.scrollTop-i.offsetHeight/2+o.getBoundingClientRect().top-i.getBoundingClientRect().top})},handleShowWhenHasToc(){const e=()=>{const e=KEEP.getStyleStatus();const t="isShowToc";if(e&&e.hasOwnProperty(t)){KEEP.utils.postHelper.hasToc(e[t])}else{KEEP.utils.postHelper.hasToc(true)}};const t="init_open";if(KEEP.theme_config.toc.hasOwnProperty(t)){KEEP.theme_config.toc[t]?e():KEEP.utils.postHelper.hasToc(false)}else{e()}}};KEEP.utils.tocHelper.handleShowWhenHasToc();KEEP.utils.tocHelper.registerTocNav()}else{o&&t.removeChild(o);if(c){e.removeChild(document.querySelector(".tablet-post-toc-mask"))}}}if(KEEP.theme_config?.pjax?.enable===true&&KEEP.utils){initTOC()}else{window.addEventListener("DOMContentLoaded",initTOC)}